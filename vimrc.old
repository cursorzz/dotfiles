" original by Long Changjin
" modified by cursorzz
" inspire from maximum-awesome
"let mapleader = ","

set nocompatible " å…³é—­å…¼å®¹æ¨¡å¼
syntax enable " æ‰“å¼€è¯­æ³•é«˜äº®
filetype on " æ‰“å¼€æ–‡ä»¶ç±»å‹æ’ä»¶

filetype off

" å®‰è£…vundle
set rtp+=~/.vim/bundle/vundle
call vundle#rc()

filetype indent plugin on " æ‰“å¼€ç¼©è¿›

set autoindent " æ‰“å¼€è‡ªåŠ¨ç¼©è¿›
set autoread " æ–‡ä»¶å¤–éƒ¨æ›´æ”¹æ—¶ï¼Œè‡ªåŠ¨è¯»å…¥

set backspace=2 "indent,eol,start   "è®¾ç½®backspaceåˆ é™¤
set directory-=.                        " swap æ–‡ä»¶å°†ä¸ä¼šå­˜åœ¨å½“å‰ç›®å½•
set nu " æ˜¾ç¤ºè¡Œå·
set encoding=utf8

set showcmd " æ˜¾ç¤ºå‘½ä»¤
set title " æ˜¾ç¤ºæ ‡é¢˜
set lz " å½“è¿è¡Œå®æ—¶ï¼Œå‘½ä»¤æœªæ‰§è¡Œå®Œä¹‹å‰ï¼Œä¸è¦é‡ç»˜å±å¹•
"set hid " å¯ä»¥åœ¨æ²¡æœ‰ä¿å­˜å¾—æƒ…å†µä¸‹åˆ‡æ¢buffer
set incsearch " å¢é‡å¼æœç´¢ï¼Œè¾¹è¾“å…¥è¾¹æœç´¢
set hlsearch " é«˜äº®æœç´¢
set viminfo='10,\"100,:20,%,n~/.viminfo
set matchpairs+=<:>

function! ResCur()
  if line("'\"") <= line("$")
    normal! g`"
    return 1
  endif
endfunction

augroup resCur
  autocmd!
  autocmd BufWinEnter * call ResCur()
augroup END
"set ignorecase " å¿½ç•¥å¤§å°å†™æœç´¢
"set nobackup " å…³é—­å¤‡ä»½
""""" Command Line
" Autocomplete features in the status bar
set wildchar=<Tab> wildmenu wildmode=longest,list,full
set wildignore=*.o,*~,*.pyc,*.swp
set lazyredraw
set mat=2
set expandtab
set smartindent
set smarttab
set shiftwidth=4
set tabstop=4

set ai " è‡ªåŠ¨ç¼©è¿›
set si " æ™ºèƒ½ç¼©è¿›
set cindent " Cç¼©è¿›
set t_Co=256
set go-=T
set background=dark
let g:solarized_termcolors=256
color solarized " é¢œè‰²ä¸»é¢˜
" æ–‡ä»¶ç¼–ç 
set laststatus=2 " æ€»æ˜¯æ˜¾ç¤ºçŠ¶æ€æ 
function! InsertStatuslineColor(mode)
  if a:mode == 'i'
    hi statusline guibg=Cray ctermfg=11 guifg=Black ctermbg=0
  elseif a:mode == 'v'
    hi statusline guibg=Purple ctermfg=11 guifg=Black ctermbg=0
  else
    hi statusline guibg=DarkRed ctermfg=15 guifg=Black ctermbg=0
  endif
endfunction

au InsertEnter * call InsertStatuslineColor(v:insertmode)
au InsertLeave * hi statusline guibg=DarkGrey ctermfg=8 guifg=White ctermbg=15

" default the statusline to green when entering Vim
hi statusline guibg=DarkGrey ctermfg=8 guifg=White ctermbg=15

" Formats the statusline
set statusline+=[%{&ff}] "file format
set statusline+=%y      "filetype
set statusline+=\ %F                           " file name
"set statusline+=\ [%{strlen(&fenc)?&fenc:'none'}, "file encoding
set statusline+=%h      "help file flag
set statusline+=%m      "modified flag
set statusline+=%r      "read only flag

" Puts in the current git status
    "if count(g:pathogen_disabled, 'Fugitive') < 1   
        "set statusline+=%{fugitive#statusline()}
    "endif

"" Puts in syntastic warnings
    "if count(g:pathogen_disabled, 'Syntastic') < 1  
        "set statusline+=%#warningmsg#
        "set statusline+=%{SyntasticStatuslineFlag()}
        "set statusline+=%*
    "endif
set statusline+=\ %=                        " align left
set statusline+=Line:%l/%L[%p%%]            " line X of Y [percent of file]
set statusline+=\ Col:%c                    " current column
set statusline+=\ Buf:%n                    " Buffer number
"set statusline+=\ [%b][0x%B]\               " ASCII and byte code under cursor
set termencoding=utf-8
set fileencodings=utf8,gb2312,gb18030,ucs-bom,latin1
"hi statusline guibg=DarkGrey ctermfg=8 guifg=White ctermbg=15
"set laststatus=2 " æ€»æ˜¯æ˜¾ç¤ºçŠ¶æ€æ 
""set laststatus=2 statusline=%02n:%<%f\ %h%m%r%=%-14.(%l,%c%V%)\ %P
""set statusline=%F%m%r%h%w\ 
"set statusline +=%1*\ %n\ %*            "buffer number
"set statusline +=%5*%{&ff}%*            "file format
"set statusline +=%3*%y%*                "file type
"set statusline +=%4*\ %<%F%*            "full path
"set statusline +=%2*%m%*                "modified flag
"set statusline +=%1*%=%5l%*             "current line
"set statusline +=%2*/%L%*               "total lines
set cursorline
"set cursorcolumn
set autochdir  "è‡ªåŠ¨åˆ‡æ¢ç›®å½•
" é¢œè‰²è®¾ç½®
"highlight CursorLine cterm=NONE ctermbg=darkred ctermfg=white guibg=#000000
"highlight CursorLine guibg=#000000
"highlight CursorColumn guibg=#000000
highlight Folded guibg=grey30 guifg=gold  "æŠ˜å 
highlight FoldColumn guibg=grey30 guifg=tan  "æŠ˜æŸ±
set cc=81 " 81åˆ—å¤„é«˜äº®
set wrap
set linebreak
set list
set listchars=tab:â–¸\ ,trail:â–«
"set listchars=tab:>-,trail:-
"set listchars=tab:>-
set clipboard=unnamed                                        " yank and paste with the system clipboard

"if has("gui_running")
	"set lines=40 columns=100
"else
	"if exists("+lines")
		"set lines=40
	"endif
	"if exists("+columns")
		"set columns=100
	"endif
"endif


"vundleè®¾ç½® begine--------------------------------------------------------
"git clone https://github.com/gmarik/vundle.git ~/.vim/bundle/vundle
let root = '~/.vim/bundle'
let src = 'http://github.com/gmarik/vundle.git'
if !isdirectory(expand(root, 1).'/vundle')
    exec '!git clone '.src.' '.shellescape(root, 1).'/vundle'
endif

set rtp+=~/.vim/bundle/vundle
call vundle#rc()
Bundle 'gmarik/vundle'

"	éœ€è¦å…ˆå®‰è£…flake8
Bundle 'vim-flake8'
Bundle 'pyflakes.vim'
"	ä½¿ç”¨vim-syntasticéœ€è¦flake8
Bundle 'scrooloose/syntastic'
"Bundle 'Lokaltog/vim-powerline'
"let g:Powerline_stl_path_style = 'short'
"Bundle 'groenewege/vim-less'
"Bundle 'lastpos.vim'
"	æ³¨é‡Šç®¡ç†æ’ä»¶
Bundle 'scrooloose/nerdcommenter'
"	 pythonæ–‡æ¡£æŸ¥æ‰¾ï¼Œä½¿ç”¨Pydoc <keyword>ï¼Œå¦‚Pydoc re
"    PydocSearch <keyword>
"    å½“å…‰æ ‡åœ¨æŸä¸ªè¯ä¸Šæ—¶æŒ‰'\pW'
"Bundle 'fs111/pydoc.vim'
"	Pythonä»£ç æŠ˜å ï¼ŒFæ¢å‘æ‰€æœ‰æŠ˜å ï¼Œfè§¦å‘å…‰æ ‡æ‰€åœ¨ä½ç½®æŠ˜å ï¼ŒShift+eæ‰§è¡Œå½“å‰è„šæœ¬
Bundle 'python.vim'
"	Pythonæ‹¼å†™æ£€æŸ¥ï¼Œ:ccå®šä½è¯­æ³•é”™è¯¯
Bundle 'vim-fugitive'
Bundle 'pangloss/vim-javascript'
Bundle 'nathanaelkane/vim-indent-guides'

" Edit xml and html easily
"Bundle 'xmledit'
autocmd FileType xml set omnifunc=xmlcomplete#CompleteTags noci
autocmd FileType html set omnifunc=htmlcomplete#CompleteTags noci
autocmd FileType python.django set omnifunc=pythoncomplete#Complete
autocmd FileType htmldjango.html set omnifunc=htmlcomplete#CompleteTags
"	pyton pep8ä»£ç é£æ ¼æ£€æŸ¥
"Bundle 'pep8.vim'
"	è‡ªåŠ¨è¯­æ³•æ£€æŸ¥ï¼Œéœ€è¦pyflakes
"	é»˜è®¤è¿…æ· é”®æ˜¯cs
"	g:pcs_hotkeyï¼Œä¿®æ”¹å¿«æ·é”®
"	g:pcs_check_when_savingï¼Œä¿å­˜æ—¶æ£€æŸ¥
"Bundle 'python_check_syntax.vim'
"Bundle 'python_fn.vim'
"	æ–‡ä»¶æµè§ˆå™¨ï¼ŒNerdTreeå‘½ä»¤
Bundle 'The-NERD-tree'
Bundle 'VimExplorer'
"Bundle 'lookupfile'
Bundle 'genutils'
"	ä½¿ç”¨Tabè¡¥å…¨Python
Bundle 'Pydiction'
"	è‡ªåŠ¨å¼¹å‡ºè¡¥å…¨çª—å£
"Bundle 'AutoComplPop'
"Bundle 'taglist.vim'
"æ¯”taglistæ›´å¥½çš„ä»£ç ç»“æ„æµè§ˆ
Bundle 'majutsushi/tagbar'
Bundle 'tpope/vim-surround'
Bundle 'xolox/vim-notes'

Bundle 'xolox/vim-misc'
:let g:notes_directories = ['~/Documents/Notes']
"Bundle 'winmanager'
"	åœ¨vimä¸­è¿è¡Œshell
"Bundle 'Conque-Shell'
"	å¿«é€Ÿæ’å…¥å†…å®¹
Bundle 'snipMate'
Bundle 'mattn/zencoding-vim'
  let g:user_zen_leader_key = '<c-y>'
Bundle 'morhetz/gruvbox'


filetype plugin indent on
"    å®‰è£…æ‰€è®¾ç½®æ’ä»¶
"    å®‰è£…ï¼šBundleInstallï¼Œæ›´æ–°ï¼šBundleInstall!ï¼Œå¸è½½ä¸åœ¨åˆ—è¡¨çš„æ’ä»¶ï¼šBundleClean
"    au VimEnter * BundleInstall
"vundleè®¾ç½® end---------------------------------------------------------------

"    python_editing.vim http://www.vim.org/scripts/script.php?script_id=1494	
"    pythonä»£ç æŠ˜å  Fé”®,ä¿å­˜åœ¨vim/ftplugin
let NERDTreeShowHidden=1
let NERDTreeShowHidden="left"
"    python_fold  http://vim.sourceforge.net/scripts/script.php?script_id=515
"    pytonä»£ç æŠ˜å  zcæŠ˜å ï¼Œzoæ‰“å¼€
"	minibufexpl æµè§ˆbuffer
"	ä½¿ç”¨<C-Tab>å’Œ<C-S-Tab>åˆ‡æ¢buffer
"	http://www.vim.org/scripts/script.php?script_id=159
"let g:miniBufExplMapWindowNavVim = 1 
"let g:miniBufExplMapWindowNavArrows = 1 
"let g:miniBufExplMapCTabSwitchBufs = 1 
"let g:miniBufExplModSelTarget = 1 

au FileType python setlocal tabstop=4 expandtab shiftwidth=4 softtabstop=4
"au FileType python setlocal foldmethod=indent  "æŠ˜å pytonä»£ç 
set foldlevel=10 "é»˜è®¤å±•å¼€æ‰€æœ‰ä»£ç 
au FileType c setlocal tabstop=8 shiftwidth=8 softtabstop=8
"au FileType c setlocal tabstop=4 expandtab shiftwidth=4 softtabstop=4

"nmap <C-_>s :cs find s <C-R>=expand("<cword>")<CR><CR>
"nmap <C-_>g :cs find g <C-R>=expand("<cword>")<CR><CR>
"nmap <C-_>c :cs find c <C-R>=expand("<cword>")<CR><CR>
"nmap <C-_>t :cs find t <C-R>=expand("<cword>")<CR><CR>
"nmap <C-_>e :cs find e <C-R>=expand("<cword>")<CR><CR>
"nmap <C-_>f :cs find f <C-R>=expand("<cfile>")<CR><CR>
"nmap <C-_>i :cs find i ^<C-R>=expand("<cfile>")<CR>$<CR>
"nmap <C-_>d :cs find d <C-R>=expand("<cword>")<CR><CR>

noremap <Leader>e :NERDTreeToggle<CR>
noremap <Leader>t :TagbarToggle<CR>

"AutoComplPopè®¾ç½®

let g:acp_enableAtStartup = 0    "å–æ¶ˆè¿è¡Œå¯ç”¨
"Pydictionè®¾ç½®
let g:pydiction_location = '~/.vim/bundle/Pydiction/complete-dict'
"snipMateè®¾ç½®
let g:snips_author = 'Long Changjin <admin@longchangjin.cn>'
"syntastic è¯­æ³•æ£€æŸ¥è®¾ç½®
let g:syntastic_check_on_open=1
let g:syntastic_quiet_warning=0
let g:syntastic_enable_signs=1
let g:syntastic_enable_highlighting=0
let g:syntastic_python_checker_args='--ignore=E501,E302,E231,E261,E201,W402,W293,W291,E225'
nmap cs :SyntasticCheck<CR>
nnoremap <F2> :set nonumber!<CR>:set foldcolumn=0<CR>
""çª—å£æ“ä½œ
vnoremap <C-x>c "+y
nnoremap <C-x>c "+p
nnoremap <Leader>r :!./% <CR>
nnoremap t :tabe 
nnoremap <Leader>/ :vsplit 
nnoremap <Leader>n :lnext<CR>
nnoremap <Leader>p :lprevious<CR>
nnoremap <Leader>w :w<CR>
inoremap <Leader>w <ESC>:w<CR>
inoremap <C-b> <C-n>
vnoremap J 6j
vnoremap K 6k
nnoremap J 6j
nnoremap K 6k
nnoremap <C-h> <C-w><Left>
nnoremap <C-l> <C-w><Right>
nnoremap <C-k> <C-w><Up>
nnoremap <C-j> <C-w><Down>
"nnoremap h :bp<CR>
"nnoremap l :bn<CR>
inoremap <Leader>( _(<ESC><Right>Ef"a)
nnoremap <Leader>` viw~<CR>

set showtabline=2  " 0, 1 or 2; when to use a tab pages line
set tabline=%!MyTabLine()  " custom tab pages line

function! MyTabLine()
  let s = ''
  let t = tabpagenr()
  let i = 1
  while i <= tabpagenr('$')
    let buflist = tabpagebuflist(i)
    let winnr = tabpagewinnr(i)
    let s .= '%' . i . 'T'
    let s .= (i == t ? '%#TabLineSel#' : '%#TabLine#')
    let bufnr = buflist[winnr - 1]
    let file = bufname(bufnr)
    let buftype = getbufvar(bufnr, 'buftype')
    if buftype == 'nofile'
      if file =~ '\/.'
        let file = substitute(file, '.*\/\ze.', '', '')
      endif
    else
      let file = fnamemodify(file, ':p:t')
    endif
    if file == ''
      let file = '[No Name]'
    endif
    let s .= string(i) . ":"
    let file = strpart(file, 0, 10)
    let s .= file
    let i = i + 1
  endwhile
  let s .= '%T%#TabLineFill#%='
  let s .= (tabpagenr('$') > 1 ? '%999XX' : 'X')
  return s
endfunction

map <leader>1 1gt
map <leader>2 2gt
map <leader>3 3gt
map <leader>4 4gt
map <leader>5 5gt
map <leader>6 6gt
map <leader>7 7gt
map <leader>8 8gt
map <leader>9 9gt
map <leader>0 10gt
"inoremap <Leader>( (<ESC><Right>Ef"a)
" To turn off caps lock
" setxkbmap -option ctrl:nocaps
" To reset
" setxkbmap -option
" when we reload, tell vim to restore the cursor to the saved position

if filereadable(expand('~/.vimrc.bundle'))
    source ~/.vimrc.bundle
endif

if filereadable(expand('~/.vimrc.local'))
    source ~/.vimrc.local
endif
set runtimepath+=$GOPATH/go/misc/vim
